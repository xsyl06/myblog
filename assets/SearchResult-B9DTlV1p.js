import{u as $,f as se,g as te,h as I,i as ae,P as le,t as re,j as ue,k as V,l as R,m as ie,w as _,n as t,p as oe,R as j,q as ne,s as ce,v as ve,C as de,x as pe,y as ye,z as he,A as Ee,B as me,D as ge,E as Ae,F as P,G as O,H as Be,I as k,J as fe}from"./app-D_MdSpv0.js";const He=["/","/statudy/JVM/01-JVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B.html","/statudy/JVM/02-%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3JVM%E6%89%A7%E8%A1%8C%E5%BC%95%E6%93%8E.html","/statudy/JVM/03-JVM%E5%AF%B9%E8%B1%A1%E5%88%9B%E5%BB%BA%E5%8F%8A%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E6%9C%BA%E5%88%B6.html","/statudy/JVM/04-JVM%E7%9A%84%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%EF%BC%88%E4%B8%8A%EF%BC%89.html","/statudy/JVM/05-JVM%E7%9A%84%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%EF%BC%88%E4%B8%8B%EF%BC%89.html","/statudy/JVM/06-JVM%E5%B7%A5%E5%85%B7%E8%AF%A6%E8%A7%A3.html","/404.html","/statudy/JVM/","/statudy/","/category/","/category/jvm/","/tag/","/tag/jvm/","/tag/%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8/","/article/","/star/","/timeline/"],Ce="SEARCH_PRO_QUERY_HISTORY",m=$(Ce,[]),Re=()=>{const{queryHistoryCount:a}=k,l=a>0;return{enabled:l,queryHistory:m,addQueryHistory:r=>{l&&(m.value=Array.from(new Set([r,...m.value.slice(0,a-1)])))},removeQueryHistory:r=>{m.value=[...m.value.slice(0,r),...m.value.slice(r+1)]}}},D=a=>He[a.id]+("anchor"in a?`#${a.anchor}`:""),ke="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:T}=k,g=$(ke,[]),we=()=>{const a=T>0;return{enabled:a,resultHistory:g,addResultHistory:l=>{if(a){const r={link:D(l),display:l.display};"header"in l&&(r.header=l.header),g.value=[r,...g.value.slice(0,T-1)]}},removeResultHistory:l=>{g.value=[...g.value.slice(0,l),...g.value.slice(l+1)]}}},Qe=a=>{const l=de(),r=I(),w=pe(),i=V(0),f=R(()=>i.value>0),y=ye([]);return he(()=>{const{search:h,terminate:Q}=Ee(),A=Be(c=>{const B=c.join(" "),{searchFilter:q=p=>p,splitWord:x,suggestionsFilter:S,...E}=l.value;B?(i.value+=1,h(c.join(" "),r.value,E).then(p=>q(p,B,r.value,w.value)).then(p=>{i.value-=1,y.value=p}).catch(p=>{console.warn(p),i.value-=1,i.value||(y.value=[])})):y.value=[]},k.searchDelay-k.suggestDelay);_([a,r],([c])=>A(c),{immediate:!0}),me(()=>{Q()})}),{isSearching:f,results:y}};var xe=se({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:l}){const r=te(),w=I(),i=ae(le),{enabled:f,addQueryHistory:y,queryHistory:h,removeQueryHistory:Q}=Re(),{enabled:A,resultHistory:c,addResultHistory:B,removeResultHistory:q}=we(),x=f||A,S=re(a,"queries"),{results:E,isSearching:p}=Qe(S),u=ue({isQuery:!0,index:0}),v=V(0),d=V(0),L=R(()=>x&&(h.value.length>0||c.value.length>0)),M=R(()=>E.value.length>0),F=R(()=>E.value[v.value]||null),U=()=>{const{isQuery:e,index:s}=u;s===0?(u.isQuery=!e,u.index=e?c.value.length-1:h.value.length-1):u.index=s-1},Y=()=>{const{isQuery:e,index:s}=u;s===(e?h.value.length-1:c.value.length-1)?(u.isQuery=!e,u.index=0):u.index=s+1},z=()=>{v.value=v.value>0?v.value-1:E.value.length-1,d.value=F.value.contents.length-1},G=()=>{v.value=v.value<E.value.length-1?v.value+1:0,d.value=0},K=()=>{d.value<F.value.contents.length-1?d.value+=1:G()},N=()=>{d.value>0?d.value-=1:z()},J=e=>e.map(s=>fe(s)?s:t(s[0],s[1])),W=e=>{if(e.type==="customField"){const s=ge[e.index]||"$content",[o,C=""]=Ae(s)?s[w.value].split("$content"):s.split("$content");return e.display.map(n=>t("div",J([o,...n,C])))}return e.display.map(s=>t("div",J(s)))},H=()=>{v.value=0,d.value=0,l("updateQuery",""),l("close")},X=()=>f?t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},i.value.queryHistory),h.value.map((e,s)=>t("div",{class:["search-pro-result-item",{active:u.isQuery&&u.index===s}],onClick:()=>{l("updateQuery",e)}},[t(P,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},e),t("button",{class:"search-pro-remove-icon",innerHTML:O,onClick:o=>{o.preventDefault(),o.stopPropagation(),Q(s)}})]))])):null,Z=()=>A?t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},i.value.resultHistory),c.value.map((e,s)=>t(j,{to:e.link,class:["search-pro-result-item",{active:!u.isQuery&&u.index===s}],onClick:()=>{H()}},()=>[t(P,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(o=>J(o)).flat())]),t("button",{class:"search-pro-remove-icon",innerHTML:O,onClick:o=>{o.preventDefault(),o.stopPropagation(),q(s)}})]))])):null;return ie("keydown",e=>{if(a.isFocusing){if(M.value){if(e.key==="ArrowUp")N();else if(e.key==="ArrowDown")K();else if(e.key==="Enter"){const s=F.value.contents[d.value];y(a.queries.join(" ")),B(s),r.push(D(s)),H()}}else if(A){if(e.key==="ArrowUp")U();else if(e.key==="ArrowDown")Y();else if(e.key==="Enter"){const{index:s}=u;u.isQuery?(l("updateQuery",h.value[s]),e.preventDefault()):(r.push(c.value[s].link),H())}}}}),_([v,d],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["search-pro-result-wrapper",{empty:a.queries.length?!M.value:!L.value}],id:"search-pro-results"},a.queries.length?p.value?t(oe,{hint:i.value.searching}):M.value?t("ul",{class:"search-pro-result-list"},E.value.map(({title:e,contents:s},o)=>{const C=v.value===o;return t("li",{class:["search-pro-result-list-item",{active:C}]},[t("div",{class:"search-pro-result-title"},e||i.value.defaultTitle),s.map((n,ee)=>{const b=C&&d.value===ee;return t(j,{to:D(n),class:["search-pro-result-item",{active:b,"aria-selected":b}],onClick:()=>{y(a.queries.join(" ")),B(n),H()}},()=>[n.type==="text"?null:t(n.type==="title"?ne:n.type==="heading"?ce:ve,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[n.type==="text"&&n.header?t("div",{class:"content-header"},n.header):null,t("div",W(n))])])})])})):i.value.emptyResult:x?L.value?[X(),Z()]:i.value.emptyHistory:i.value.emptyResult)}});export{xe as default};
